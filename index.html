<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create Digital Business - Professional E-Commerce Suite</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2563eb">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<style>
body{
  margin:0;
  font-family:'Poppins',system-ui;
  background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height:100vh;
  color: #1e293b;
}

.wrap{
  max-width:480px;
  margin:auto;
  padding:20px;
}

h2{
  margin-top:20px;
  margin-bottom:10px;
  color:#0f172a;
  display:flex;
  align-items:center;
  gap:10px;
  font-size:18px;
  font-weight:600;
  background: rgba(255, 255, 255, 0.95);
  padding: 12px 16px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  border: 2px solid rgba(102, 126, 234, 0.3);
}

.section-heading {
  color: #0f172a;
  font-size: 18px;
  font-weight: 600;
  margin: 20px 0 10px 0;
  padding: 12px 16px;
  background: rgba(255, 255, 255, 0.95);
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  border: 2px solid rgba(102, 126, 234, 0.3);
  display: flex;
  align-items: center;
  gap: 10px;
}

input,textarea,select{
  width:100%;
  padding:14px;
  margin:8px 0;
  border-radius:12px;
  border:2px solid rgba(102, 126, 234, 0.3);
  box-sizing:border-box;
  font-size:15px;
  background:rgba(255,255,255,0.95);
  color: #1e293b;
  font-family: 'Poppins', sans-serif;
}

input:focus, textarea:focus, select:focus {
  outline: none;
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
}

button{
  width:100%;
  padding:18px;
  border:none;
  border-radius:14px;
  background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color:white;
  font-size:17px;
  margin-top:20px;
  cursor:pointer;
  font-weight:600;
  box-shadow:0 8px 25px rgba(102,126,234,0.4);
  font-family: 'Poppins', sans-serif;
  transition: all 0.3s;
}

button:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 30px rgba(102,126,234,0.5);
}

.form-section{
  background:rgba(255,255,255,0.95);
  border-radius:20px;
  padding:20px;
  margin-bottom:20px;
  box-shadow:0 10px 30px rgba(0,0,0,0.1);
  border: 2px solid rgba(255,255,255,0.2);
}

.social-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 10px;
  margin-top: 10px;
}

.social-input {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px;
  background: #f8fafc;
  border-radius: 10px;
  border: 1px solid #e2e8f0;
  transition: all 0.3s;
}

.social-input:hover {
  border-color: #667eea;
  background: white;
}

.social-input i {
  color: #666;
  font-size: 18px;
  width: 24px;
}

.social-input input {
  flex: 1;
  border: none;
  background: transparent;
  padding: 0;
  margin: 0;
  font-size: 14px;
  color: #1e293b;
}

.social-input input:focus {
  outline: none;
}

.offers-container {
  display: flex;
  gap: 16px;
  overflow-x: auto;
  padding: 10px 0;
  margin-top: 10px;
  scrollbar-width: thin;
}

.offers-container::-webkit-scrollbar {
  height: 6px;
}

.offers-container::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 10px;
}

.offers-container::-webkit-scrollbar-thumb {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 10px;
}

.offer-box {
  min-width: 280px;
  background: white;
  border-radius: 16px;
  padding: 16px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  border: 1px solid #e2e8f0;
}

.offer-box h3 {
  margin-top: 0;
  color: #1e293b;
  font-size: 16px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
  padding-bottom: 10px;
  border-bottom: 1px solid #e2e8f0;
}

.badgeGrid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:8px;
  margin-top:10px;
  font-size:14px;
}
.badgeGrid label{
  display:flex;
  gap:8px;
  align-items:center;
  cursor:pointer;
  color: #475569;
  padding: 6px 8px;
  border-radius: 6px;
  transition: all 0.2s;
}

.badgeGrid label:hover {
  background: #f1f5f9;
}

.badgeGrid input[type="checkbox"] {
  accent-color: #667eea;
}

.dayBox{
  background:#fff;
  padding:10px;
  border-radius:10px;
  margin-bottom:8px;
  display:grid;
  grid-template-columns:28px 1fr;
  gap:8px;
  align-items:center;
  border:1px solid #e2e8f0;
}
.dayCheck{display:flex;justify-content:center}
.dayContent{display:flex;flex-direction:column;gap:6px}
.dayRow{display:flex;align-items:center;gap:8px}
.dayRow label{font-weight:500;min-width:80px; color: #475569;}

.holidayBox{
  background:#fff;
  padding:16px;
  border-radius:12px;
  margin:12px 0;
  border:1px solid #e2e8f0;
}
.holidayHeader{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:12px;
}
.holidayHeader h2 {
  background: transparent;
  border: none;
  padding: 0;
  margin: 0;
  box-shadow: none;
}
.addHolidayBtn{
  background:#10b981;
  color:white;
  border:none;
  padding:8px 16px;
  border-radius:8px;
  cursor:pointer;
  font-size:14px;
  font-weight:500;
  transition: all 0.3s;
}
.addHolidayBtn:hover {
  background: #0da271;
  transform: translateY(-2px);
}
.holidayItem{
  display:grid;
  grid-template-columns:1fr 120px auto;
  gap:10px;
  align-items:center;
  margin:8px 0;
  padding:10px;
  background:#f8fafc;
  border-radius:10px;
  border:1px solid #e2e8f0;
}
.holidayItem input[type="text"]{
  padding:10px;
  border:1px solid #e2e8f0;
  border-radius:8px;
  font-size:14px;
  background:white;
  color: #1e293b;
}
.holidayItem input[type="date"]{
  padding:10px;
  border:1px solid #e2e8f0;
  border-radius:8px;
  font-size:14px;
  min-width:120px;
  background:white;
  color:#334155;
}
.removeHoliday{
  background:#ef4444;
  color:white;
  border:none;
  border-radius:8px;
  padding:10px 14px;
  cursor:pointer;
  font-size:16px;
  font-weight:bold;
  min-width:40px;
  height:40px;
  display:flex;
  align-items:center;
  justify-content:center;
  transition: all 0.3s;
}
.removeHoliday:hover{
  background:#dc2626;
  transform: scale(1.05);
}

.delivery-settings {
  background: white;
  border-radius: 16px;
  padding: 16px;
  margin: 12px 0;
  border: 1px solid #e2e8f0;
}

.delivery-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin: 12px 0;
}

.delivery-input-group {
  margin-bottom: 12px;
}

.delivery-input-group label {
  display: block;
  margin-bottom: 6px;
  color: #475569;
  font-weight: 600;
  font-size: 14px;
}

.delivery-input-group input {
  width: 100%;
  padding: 10px;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  font-size: 14px;
  background: white;
  color: #1e293b;
}

.delivery-input-group input:focus {
  outline: none;
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.delivery-zones-container {
  margin-top: 20px;
  border-top: 2px solid #e2e8f0;
  padding-top: 16px;
}

.zone-item {
  display: grid;
  grid-template-columns: 1fr 100px 100px auto;
  gap: 8px;
  align-items: center;
  margin-bottom: 10px;
  padding: 12px;
  background: #f8fafc;
  border-radius: 10px;
  border: 1px solid #e2e8f0;
}

.zone-item input {
  padding: 8px;
  margin: 0;
  font-size: 13px;
}

.zone-actions {
  display: flex;
  gap: 6px;
}

.add-zone-btn {
  background: #8b5cf6;
  padding: 10px;
  margin-top: 10px;
  font-size: 14px;
}

.payment-gateways {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin: 20px 0;
}

.payment-option-card {
  background: white;
  border: 2px solid #e2e8f0;
  border-radius: 12px;
  padding: 16px;
  display: flex;
  align-items: flex-start;
  gap: 15px;
  cursor: pointer;
  transition: all 0.3s;
  position: relative;
}

.payment-option-card:hover {
  border-color: #667eea;
  background: #f8fafc;
  transform: translateY(-2px);
}

.payment-option-card.selected {
  border-color: #10b981;
  background: #f0fdf4;
}

.payment-icon {
  width: 50px;
  height: 50px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  color: white;
  flex-shrink: 0;
}

.payment-details {
  flex: 1;
}

.payment-name {
  font-weight: 700;
  color: #1e293b;
  margin-bottom: 4px;
  font-size: 16px;
}

.payment-fields {
  margin-top: 12px;
  display: none;
  animation: slideDown 0.3s ease;
}

.payment-option-card.selected .payment-fields {
  display: block;
}

.payment-fields input,
.payment-fields select {
  width: 100%;
  padding: 10px;
  margin: 6px 0;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  font-size: 13px;
  background: white;
}

.payment-fields input:focus,
.payment-fields select:focus {
  border-color: #667eea;
  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
}

.payment-barcode-preview {
  margin-top: 8px;
  padding: 12px;
  background: #f8fafc;
  border-radius: 8px;
  display: flex;
  align-items: center;
  gap: 12px;
}

.payment-barcode-preview img {
  max-width: 60px;
  max-height: 60px;
  border-radius: 6px;
}

.token-settings {
  background: linear-gradient(135deg, #667eea10 0%, #764ba210 100%);
  border-radius: 16px;
  padding: 20px;
  margin-top: 20px;
  border: 2px solid rgba(102, 126, 234, 0.3);
}

.token-settings h4 {
  color: #4c51bf;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 16px;
  font-weight: 700;
}

.token-format-preview {
  background: #1e293b;
  color: #e2e8f0;
  font-family: monospace;
  padding: 12px;
  border-radius: 8px;
  font-size: 14px;
  margin-top: 8px;
  letter-spacing: 1px;
}

.ticket-settings {
  background: #f0f9ff;
  border-radius: 12px;
  padding: 16px;
  margin-top: 20px;
  border: 1px solid #bae6fd;
}

.ticket-settings h4 {
  color: #0369a1;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.ticket-template {
  background: white;
  border-radius: 8px;
  padding: 12px;
  margin-top: 10px;
  border-left: 4px solid #0ea5e9;
}

@media (max-width:480px){
  .holidayItem{
    grid-template-columns:1fr;
    gap:8px;
  }
  .holidayItem input[type="date"]{
    min-width:100%;
  }
  .social-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  .delivery-grid {
    grid-template-columns: 1fr;
  }
  .zone-item {
    grid-template-columns: 1fr;
    gap: 8px;
  }
}

.payment-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.7);
  backdrop-filter: blur(5px);
  z-index: 99999;
  justify-content: center;
  align-items: center;
  pointer-events: auto !important;
}

.payment-content {
  background: white;
  border-radius: 20px;
  width: 90%;
  max-width: 400px;
  max-height: 90vh;
  overflow-y: auto;
  padding: 0;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  pointer-events: auto !important;
  position: relative;
  z-index: 999999;
}

.payment-header {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 20px;
  border-radius: 20px 20px 0 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.payment-header h2 {
  margin: 0;
  color: white;
  background: transparent;
  border: none;
  padding: 0;
  box-shadow: none;
  font-size: 20px;
}

.close-payment {
  background: rgba(255,255,255,0.2);
  color: white;
  border: none;
  border-radius: 8px;
  padding: 8px 12px;
  cursor: pointer;
  font-size: 16px;
  transition: all 0.3s;
  pointer-events: auto !important;
}
.close-payment:hover {
  background: rgba(255,255,255,0.3);
}

.whatsapp-preview {
  margin: 20px;
  padding: 15px;
  background: #f8fafc;
  border-radius: 12px;
  border-left: 4px solid #25D366;
}
.whatsapp-preview h4 {
  color: #25D366;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  gap: 8px;
}
.preview-message {
  background: white;
  padding: 12px;
  border-radius: 8px;
  font-size: 14px;
  color: #1e293b;
  margin-bottom: 10px;
  line-height: 1.5;
  white-space: pre-line;
}

.form-label {
  color: #0f172a;
  font-weight: 600;
  margin-bottom: 5px;
  display: block;
  font-size: 14px;
}

input[type="file"] {
  padding: 10px;
  background: white;
  border: 2px dashed #cbd5f5;
  border-radius: 10px;
  cursor: pointer;
  pointer-events: auto !important;
}

input[type="file"]:hover {
  border-color: #667eea;
  background: #f8fafc;
}

h2 i {
  color: #667eea;
}

.success-message {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
  color: white;
  padding: 15px 25px;
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
  z-index: 200000;
  max-width: 300px;
  animation: slideDown 0.5s ease;
  font-weight: 700;
  font-size: 14px;
  text-align: center;
  display: none;
  pointer-events: none;
}

@keyframes slideDown {
  from { top: -100px; opacity: 0; }
  to { top: 20px; opacity: 1; }
}

.loading-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.8);
  backdrop-filter: blur(10px);
  z-index: 300000;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  pointer-events: none;
}

.loading-spinner {
  width: 60px;
  height: 60px;
  border: 4px solid rgba(255,255,255,0.3);
  border-top: 4px solid white;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin-bottom: 20px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.loading-text {
  color: white;
  font-size: 18px;
  font-weight: 600;
}

.payment-badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 700;
  margin-left: 8px;
}

.payment-badge.active {
  background: #10b981;
  color: white;
}

.payment-badge.inactive {
  background: #ef4444;
  color: white;
}

.token-preview {
  background: #1e293b;
  border-radius: 8px;
  padding: 12px;
  margin: 10px 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.token-code {
  font-family: monospace;
  font-size: 16px;
  font-weight: 700;
  color: #10b981;
  letter-spacing: 2px;
}

.token-copy-btn {
  background: #334155;
  color: white;
  border: none;
  border-radius: 4px;
  padding: 6px 12px;
  font-size: 12px;
  cursor: pointer;
}

.token-copy-btn:hover {
  background: #475569;
}

.payment-modal * {
  pointer-events: auto !important;
}

.payment-fields,
.payment-fields input,
.payment-fields select,
.payment-fields textarea,
.payment-fields button,
.payment-fields div,
.payment-details,
.payment-option-card,
.payment-option-card * {
  pointer-events: auto !important;
  cursor: text !important;
}

.payment-fields input,
.payment-fields select,
.payment-fields textarea {
  background: white !important;
  border: 2px solid #e2e8f0 !important;
  color: #1e293b !important;
  opacity: 1 !important;
  visibility: visible !important;
  display: block !important;
  position: relative !important;
  z-index: 999999 !important;
  pointer-events: auto !important;
  cursor: text !important;
  -webkit-user-select: auto !important;
  user-select: auto !important;
}

.payment-fields select {
  cursor: pointer !important;
}

.payment-fields input[type="file"] {
  cursor: pointer !important;
}

.payment-fields input:hover,
.payment-fields select:hover,
.payment-fields textarea:hover {
  border-color: #667eea !important;
}

.payment-fields input:focus,
.payment-fields select:focus,
.payment-fields textarea:focus {
  outline: none !important;
  border-color: #667eea !important;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2) !important;
}

.payment-option-card {
  cursor: pointer !important;
}

.payment-option-card.selected .payment-fields {
  display: block !important;
}

.payment-content,
.payment-details,
.payment-gateways,
.token-settings,
.ticket-settings {
  pointer-events: auto !important;
}

.payment-modal {
  pointer-events: auto !important;
}

#paymentModal input:not([type="checkbox"]),
#paymentModal select,
#paymentModal textarea {
  pointer-events: auto !important;
  cursor: text !important;
}

#paymentModal input[type="checkbox"] {
  cursor: pointer !important;
  width: 18px;
  height: 18px;
}

#paymentModal label {
  cursor: pointer !important;
}

#fields-jazzcash input,
#fields-jazzcash select,
#fields-easypaisa input,
#fields-easypaisa select,
#fields-bank input,
#fields-bank select,
#fields-card input,
#fields-card select,
#fields-cod input,
#fields-cod select {
  pointer-events: auto !important;
  cursor: text !important;
  background: white !important;
  border: 2px solid #e2e8f0 !important;
  padding: 10px !important;
  margin: 6px 0 !important;
  border-radius: 8px !important;
}

#jazzcashBarcode,
#easypaisaBarcode {
  cursor: pointer !important;
}

.payment-fields select {
  cursor: pointer !important;
  appearance: auto !important;
  -webkit-appearance: menulist !important;
}

.wrap *,
.form-section *,
.payment-modal * {
  pointer-events: auto !important;
}

.social-input input {
  pointer-events: auto !important;
}

.dayBox input,
.dayBox select {
  pointer-events: auto !important;
}
</style>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
<div class="wrap">

<!-- Success Message -->
<div class="success-message" id="successMessage"></div>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
  <div class="loading-spinner"></div>
  <div class="loading-text">Creating your professional digital business...</div>
</div>

<div class="form-section">
<h2><i class="fas fa-user" style="color:#667eea;"></i> Owner Profile Information</h2>
<input type="file" id="profileImage" accept="image/*">
<input id="ownerName" placeholder="Owner Full Name (Required)" required>
<input id="phoneNumber" placeholder="Business Phone Number (Required)" type="tel" required>
<input id="email" placeholder="Business Email Address" type="email">
<input id="address" placeholder="Business Address (Required for delivery)" required>
</div>

<div class="form-section">
<h2><i class="fas fa-building" style="color:#667eea;"></i> Business Details</h2>
<input id="businessName" placeholder="Business Name / Title (Required)" required>
<textarea id="businessDescription" placeholder="About your business - description, services, etc." rows="4"></textarea>
<input id="businessType" placeholder="Business Type / Category (e.g., Retail, Food, Services)" value="Digital Business">

<h2 style="margin-top:25px"><i class="fas fa-link" style="color:#667eea;"></i> Website & Social Media</h2>
<input type="url" id="website" placeholder="https://yourbusiness.com">

<div class="social-grid">
  <div class="social-input">
    <i class="fab fa-facebook" style="color:#1877F2;"></i>
    <input type="text" id="facebook" placeholder="Facebook Page URL">
  </div>
  <div class="social-input">
    <i class="fab fa-instagram" style="color:#E4405F;"></i>
    <input type="text" id="instagram" placeholder="Instagram URL">
  </div>
  <div class="social-input">
    <i class="fab fa-twitter" style="color:#1DA1F2;"></i>
    <input type="text" id="twitter" placeholder="Twitter URL">
  </div>
  <div class="social-input">
    <i class="fab fa-linkedin" style="color:#0A66C2;"></i>
    <input type="text" id="linkedin" placeholder="LinkedIn URL">
  </div>
  <div class="social-input">
    <i class="fab fa-youtube" style="color:#FF0000;"></i>
    <input type="text" id="youtube" placeholder="YouTube Channel">
  </div>
  <div class="social-input">
    <i class="fab fa-tiktok" style="color:#000000;"></i>
    <input type="text" id="tiktok" placeholder="TikTok URL">
  </div>
</div>
</div>

<div class="form-section">
<h2><i class="fas fa-clock" style="color:#667eea;"></i> Business Hours</h2>
<div id="daysContainer"></div>
</div>

<div class="form-section">
<h2><i class="fas fa-calendar-times" style="color:#667eea;"></i> Holidays / Closed Days</h2>
<div id="holidaysContainer">
  <div class="holidayItem">
   <input type="text" class="holidayName" placeholder="E.g., Eid ul-Fitr" value="Eid ul-Fitr">
   <input type="date" class="holidayDate">
   <button type="button" class="removeHoliday" onclick="removeHoliday(this)">√ó</button>
  </div>
</div>
<button type="button" class="addHolidayBtn" onclick="addHoliday()">+ Add Holiday</button>
</div>

<!-- COMPLETE DELIVERY SETTINGS -->
<div class="form-section">
<h2><i class="fas fa-truck" style="color:#667eea;"></i> Delivery Settings</h2>

<div class="delivery-settings">
  <h3 style="color:#1e293b; margin-bottom:15px; font-size:16px; font-weight:700;">
    <i class="fas fa-map-marker-alt"></i> Default Delivery Configuration
  </h3>
  
  <div class="delivery-grid">
    <div class="delivery-input-group">
      <label for="deliveryChargeCity">Same City - Delivery Charge (PKR)</label>
      <input type="number" id="deliveryChargeCity" placeholder="e.g., 150" min="0" value="150">
      <small style="color:#64748b;">Standard charge for same city</small>
    </div>
    
    <div class="delivery-input-group">
      <label for="deliveryChargeOther">Other Cities - Delivery Charge (PKR)</label>
      <input type="number" id="deliveryChargeOther" placeholder="e.g., 300" min="0" value="300">
      <small style="color:#64748b;">Charge for other cities</small>
    </div>
  </div>
  
  <div class="delivery-grid">
    <div class="delivery-input-group">
      <label for="deliveryTimeCity">Same City - Delivery Time</label>
      <input type="text" id="deliveryTimeCity" placeholder="e.g., 1-2 business days" value="1-2 business days">
    </div>
    
    <div class="delivery-input-group">
      <label for="deliveryTimeOther">Other Cities - Delivery Time</label>
      <input type="text" id="deliveryTimeOther" placeholder="e.g., 3-5 business days" value="3-5 business days">
    </div>
  </div>
  
  <div class="delivery-input-group">
    <label for="freeDeliveryMin">Free Delivery Minimum Order (PKR)</label>
    <input type="number" id="freeDeliveryMin" placeholder="e.g., 2000" min="0" value="2000">
    <small style="color:#64748b;">Orders above this amount get free delivery</small>
  </div>
  
  <!-- MULTI-ZONE DELIVERY -->
  <div class="delivery-zones-container">
    <h4 style="display:flex; align-items:center; gap:8px; color:#475569; margin-bottom:15px;">
      <i class="fas fa-location-dot" style="color:#667eea;"></i> 
      Specific City/Zone Based Delivery (Optional)
    </h4>
    <p style="font-size:13px; color:#64748b; margin-bottom:15px;">
      Configure different charges and delivery times for specific cities
    </p>
    
    <div id="deliveryZonesList"></div>
    
    <button type="button" class="add-zone-btn" onclick="addDeliveryZone()" style="background:#8b5cf6; width:100%;">
      <i class="fas fa-plus-circle"></i> Add Specific Zone/City
    </button>
  </div>
</div>
</div>

<div class="form-section">
<h2><i class="fas fa-gift" style="color:#667eea;"></i> Products / Services</h2>
<div id="productsContainer"></div>
<button type="button" onclick="addProduct()" style="background:linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);margin-top:12px">
 <i class="fas fa-plus"></i> Add Product / Service
</button>
</div>

<button type="button" onclick="openPaymentModal()" style="background:linear-gradient(135deg, #059669 0%, #10b981 100%);margin-top:24px;" id="paymentButton">
  <i class="fas fa-credit-card"></i> Configure Payments, Tokens & Tickets
</button>

<button type="button" onclick="createBusiness()" style="background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);margin-top:24px; font-size:18px; padding:20px;" id="createBusinessButton">
 <i class="fas fa-store"></i> üöÄ CREATE BUSINESS NOW üöÄ
</button>
</div>

<!-- PAYMENT, TOKEN & TICKET MODAL -->
<div class="payment-modal" id="paymentModal">
  <div class="payment-content">
    <div class="payment-header">
      <h2><i class="fas fa-cog"></i> Payment & Token System</h2>
      <button class="close-payment" onclick="closePaymentModal()">√ó</button>
    </div>
    
    <div style="padding:20px; max-height:70vh; overflow-y:auto;">
      <!-- WhatsApp Settings -->
      <h3 style="color: #1e293b; margin-bottom: 15px; font-size: 18px; font-weight: 600; display:flex; align-items:center; gap:8px;">
        <i class="fab fa-whatsapp" style="color:#25D366;"></i> WhatsApp Business
      </h3>
      
      <div style="margin:20px 0; padding:16px; background:#f0f9ff; border-radius:12px;">
        <label style="font-weight:600;display:block;margin-bottom:8px;color: #475569;">WhatsApp Number with Country Code</label>
        <input type="text" id="whatsappNumber" placeholder="+923001234567" value="+92" style="width:100%;padding:12px;border:2px solid #e2e8f0;border-radius:10px;color: #1e293b; pointer-events:auto !important; cursor:text !important;">
        <small style="color:#666;display:block;margin-top:5px;">This number will receive all order notifications with tokens</small>
      </div>
      
      <div class="whatsapp-preview">
        <h4><i class="fab fa-whatsapp"></i> Order Confirmation with Token</h4>
        <div class="preview-message" id="whatsappPreview">
üéâ *NEW ORDER CONFIRMED* - TOKEN: TKT-123456-A7F2

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
*Order ID:* ORD-12345678
*Token:* TKT-123456-A7F2
*Customer:* [Customer Name]
*Phone:* [Customer Phone]
*Address:* [Full Address]

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
*ITEMS:*
‚Ä¢ Product 1 (Qty: 1) - PKR 1,000

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
*Subtotal:* PKR 1,000
*Delivery:* PKR 150
*TOTAL:* PKR 1,150

*Payment:* Cash on Delivery
*Est. Delivery:* 1-2 business days

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Thank you for your order! üõçÔ∏è
        </div>
      </div>
      
      <!-- TOKEN SYSTEM SETTINGS -->
      <div class="token-settings">
        <h4><i class="fas fa-ticket-alt" style="color:#667eea;"></i> Order Token System</h4>
        
        <div style="margin:15px 0;">
          <div style="display:flex; align-items:center; gap:10px; margin-bottom:12px;">
            <input type="checkbox" id="enableTokenSystem" checked style="width:18px; height:18px; pointer-events:auto !important; cursor:pointer !important;">
            <label for="enableTokenSystem" style="color:#1e293b; font-weight:600; cursor:pointer !important;">
              Enable automatic token generation for all orders
            </label>
          </div>
        </div>
        
        <div style="margin-bottom:15px;">
          <label style="font-weight:600;display:block;margin-bottom:8px;color: #475569;">Token Prefix</label>
          <input type="text" id="tokenPrefix" placeholder="e.g., TKT" value="TKT" style="width:100%;padding:10px;border:1px solid #e2e8f0;border-radius:6px;">
        </div>
        
        <div class="token-format-preview" id="tokenPreview">
          TKT-12345678-A1B2
        </div>
      </div>
      
      <!-- PAYMENT GATEWAYS -->
      <h3 style="color: #1e293b; margin: 30px 0 15px; font-size: 18px; font-weight: 600; display:flex; align-items:center; gap:8px;">
        <i class="fas fa-credit-card"></i> Payment Gateways
        <span class="payment-badge active">Active</span>
      </h3>
      
      <div class="payment-gateways" id="paymentGateways">
        <!-- JazzCash -->
        <div class="payment-option-card" onclick="selectPaymentGateway('jazzcash')" id="gateway-jazzcash">
          <div class="payment-icon" style="background:#FF6B00;">
            <i class="fas fa-mobile-alt"></i>
          </div>
          <div class="payment-details">
            <div class="payment-name">JazzCash</div>
            <div style="font-size:12px; color:#64748b;">Mobile Wallet</div>
            <div class="payment-fields" id="fields-jazzcash">
              <input type="text" id="jazzcashNumber" placeholder="JazzCash Account Number" value="03001234567">
              <div style="display:flex; gap:8px; margin-top:8px;">
                <input type="file" id="jazzcashBarcode" accept="image/*" style="flex:1;">
              </div>
            </div>
          </div>
        </div>
        
        <!-- EasyPaisa -->
        <div class="payment-option-card" onclick="selectPaymentGateway('easypaisa')" id="gateway-easypaisa">
          <div class="payment-icon" style="background:#0A5C36;">
            <i class="fas fa-wallet"></i>
          </div>
          <div class="payment-details">
            <div class="payment-name">EasyPaisa</div>
            <div style="font-size:12px; color:#64748b;">Mobile Account</div>
            <div class="payment-fields" id="fields-easypaisa">
              <input type="text" id="easypaisaNumber" placeholder="EasyPaisa Account Number" value="03001234567">
              <div style="display:flex; gap:8px; margin-top:8px;">
                <input type="file" id="easypaisaBarcode" accept="image/*" style="flex:1;">
              </div>
            </div>
          </div>
        </div>
        
        <!-- Bank Transfer -->
        <div class="payment-option-card" onclick="selectPaymentGateway('bank')" id="gateway-bank">
          <div class="payment-icon" style="background:#2563eb;">
            <i class="fas fa-university"></i>
          </div>
          <div class="payment-details">
            <div class="payment-name">Bank Transfer</div>
            <div style="font-size:12px; color:#64748b;">Direct Deposit</div>
            <div class="payment-fields" id="fields-bank">
              <select id="bankName">
                <option value="HBL">Habib Bank (HBL)</option>
                <option value="UBL">United Bank (UBL)</option>
                <option value="MCB">MCB Bank</option>
                <option value="Meezan">Meezan Bank</option>
              </select>
              <input type="text" id="accountTitle" placeholder="Account Title" value="Business Account">
              <input type="text" id="accountNumber" placeholder="Account Number" value="1234567890">
            </div>
          </div>
        </div>
        
        <!-- Card Payment -->
        <div class="payment-option-card" onclick="selectPaymentGateway('card')" id="gateway-card">
          <div class="payment-icon" style="background:#8b5cf6;">
            <i class="fas fa-credit-card"></i>
          </div>
          <div class="payment-details">
            <div class="payment-name">Card Payment</div>
            <div style="font-size:12px; color:#64748b;">Visa/Mastercard</div>
            <div class="payment-fields" id="fields-card">
              <input type="text" id="merchantId" placeholder="API Key / Publishable Key" value="pk_test_xxxx">
            </div>
          </div>
        </div>
        
        <!-- Cash on Delivery -->
        <div class="payment-option-card selected" onclick="selectPaymentGateway('cod')" id="gateway-cod">
          <div class="payment-icon" style="background:#10b981;">
            <i class="fas fa-truck"></i>
          </div>
          <div class="payment-details">
            <div class="payment-name">Cash on Delivery</div>
            <div style="font-size:12px; color:#64748b;">COD</div>
            <div class="payment-fields" id="fields-cod">
              <div style="display:flex; align-items:center; gap:8px;">
                <input type="checkbox" id="codEnabled" checked style="width:18px; height:18px;">
                <label for="codEnabled">Enable COD</label>
              </div>
              <input type="number" id="codMinimumOrder" placeholder="Minimum order amount" value="500">
            </div>
          </div>
        </div>
      </div>
      
      <!-- TICKET SETTINGS -->
      <div class="ticket-settings">
        <h4><i class="fas fa-ticket-alt"></i> Order Ticket System</h4>
        
        <div style="margin:15px 0;">
          <div style="display:flex; align-items:center; gap:10px; margin-bottom:12px;">
            <input type="checkbox" id="enableAutoTickets" checked style="width:18px; height:18px;">
            <label for="enableAutoTickets">Generate order tickets on confirmation</label>
          </div>
        </div>
        
        <div class="ticket-template">
          <div style="font-weight:700; color:#0369a1; margin-bottom:8px;">üé´ Ticket Format</div>
          <div style="font-size:13px; background:white; padding:10px; border-radius:6px; font-family: monospace;">
            {PREFIX}-{ORDER_ID}-{DATE}-{RANDOM}
          </div>
        </div>
        
        <div style="margin-top:15px;">
          <label style="font-weight:600;display:block;margin-bottom:8px;">Ticket Prefix</label>
          <input type="text" id="ticketPrefix" placeholder="e.g., TKT" value="TKT">
        </div>
      </div>
      
      <button onclick="savePaymentSettings()" style="width:100%;padding:15px;background:linear-gradient(135deg, #25D366 0%, #128C7E 100%);color:white;border:none;border-radius:12px;font-size:16px;font-weight:600;margin-top:20px;">
        <i class="fas fa-save"></i> Save Payment Settings
      </button>
    </div>
  </div>
</div>

<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
// ===== SUPABASE CLIENT =====
const { createClient } = supabase;
const supabaseClient = createClient(
  "https://dfvnefbxgayxqgjjgtrr.supabase.co",
  "sb_publishable_WypeFELCIlVDlqGY4PdWwA_snqoPUSE"
);

// ===== GLOBAL VARIABLES =====
let productCount = 0;
let selectedPaymentGateways = ['cod'];

// ===== UI HELPERS =====
function showSuccess(message) {
  const el = document.getElementById('successMessage');
  el.textContent = message;
  el.style.display = 'block';
  setTimeout(() => el.style.display = 'none', 3000);
}

function showLoading() {
  document.getElementById('loadingOverlay').style.display = 'flex';
}

function hideLoading() {
  document.getElementById('loadingOverlay').style.display = 'none';
}

// ===== BUSINESS HOURS =====
const days = ["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];
days.forEach(d => {
 const container = document.getElementById("daysContainer");
 const dayBox = document.createElement("div");
 dayBox.className = "dayBox";
 dayBox.innerHTML = `
  <div class="dayCheck">
   <input type="checkbox" checked class="dayOpen">
  </div>
  <div class="dayContent">
   <div class="dayRow">
    <label style="min-width:100px">${d}</label>
    <select class="dayStatus" style="width:100px;padding:6px;">
     <option value="open">Open</option>
     <option value="closed">Closed</option>
    </select>
   </div>
   <div class="dayRow">
    <input type="time" class="dayStart" value="09:00" style="width:100px;padding:6px;">
    <span>to</span>
    <input type="time" class="dayEnd" value="17:00" style="width:100px;padding:6px;">
   </div>
  </div>
 `;
 container.appendChild(dayBox);
});

// ===== HOLIDAY MANAGEMENT =====
function addHoliday() {
 const container = document.getElementById('holidaysContainer');
 const item = document.createElement('div');
 item.className = 'holidayItem';
 item.innerHTML = `
  <input type="text" class="holidayName" placeholder="Holiday name">
  <input type="date" class="holidayDate" value="${new Date().toISOString().split('T')[0]}">
  <button type="button" class="removeHoliday" onclick="removeHoliday(this)">√ó</button>
 `;
 container.appendChild(item);
}

function removeHoliday(btn) {
 btn.parentElement.remove();
}

// ===== PRODUCT MANAGEMENT =====
function addProduct() {
 productCount++;
 const container = document.getElementById('productsContainer');
 const box = document.createElement("div");
 box.className = "offer-box";
 box.innerHTML = `
  <h3><i class="fas fa-tag"></i> Product ${productCount}</h3>
  <input type="file" class="productImage" accept="image/*" style="width:100%;margin:10px 0;">
  <input class="productTitle" placeholder="Product Title" style="margin:8px 0;padding:12px;">
  <textarea class="productDescription" placeholder="Product Description" rows="2" style="margin:8px 0;padding:12px;"></textarea>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin:10px 0;">
    <input type="number" class="originalPrice" placeholder="Original Price" style="padding:12px;">
    <input type="number" class="discountPrice" placeholder="Discounted Price" style="padding:12px;">
  </div>
  <input class="offerTag" placeholder="Offer Tag (e.g., 40% OFF, Buy 1 Get 1)" style="margin:8px 0;padding:12px;">
  <div class="badgeGrid">
   <label><input type="checkbox" value="üî• Hot Deal"> Hot Deal</label>
   <label><input type="checkbox" value="‚≠ê Best Seller"> Best Seller</label>
   <label><input type="checkbox" value="üí∏ Discount"> Discount</label>
   <label><input type="checkbox" value="‚è≥ Limited"> Limited</label>
   <label><input type="checkbox" value="üÜï New"> New</label>
  </div>
 `;
 container.appendChild(box);
 document.getElementById('productsContainer').classList.add('offers-container');
}

// ===== DELIVERY ZONE MANAGEMENT =====
function addDeliveryZone() {
  const container = document.getElementById('deliveryZonesList');
  const zoneId = 'zone_' + Date.now();
  const item = document.createElement('div');
  item.className = 'zone-item';
  item.id = zoneId;
  item.innerHTML = `
    <input type="text" class="zone-name" placeholder="City Name">
    <input type="number" class="zone-charge" placeholder="Charge (PKR)">
    <input type="text" class="zone-time" placeholder="Delivery Time">
    <div class="zone-actions">
      <button type="button" onclick="this.parentElement.parentElement.remove()" style="background:#ef4444; padding:8px; width:40px; height:40px;">
        <i class="fas fa-trash"></i>
      </button>
    </div>
  `;
  container.appendChild(item);
}

// ===== PAYMENT GATEWAY SELECTION =====
function selectPaymentGateway(gateway) {
  selectedPaymentGateways = [gateway];
  document.querySelectorAll('.payment-option-card').forEach(c => c.classList.remove('selected'));
  document.getElementById(`gateway-${gateway}`)?.classList.add('selected');
}

// ===== TOKEN GENERATION =====
function generateToken() {
  const prefix = document.getElementById('tokenPrefix')?.value || 'TKT';
  const timestamp = Date.now().toString().slice(-8);
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
  let random = '';
  for (let i = 0; i < 4; i++) random += chars.charAt(Math.floor(Math.random() * chars.length));
  return `${prefix}-${timestamp}-${random}`;
}

// ===== IMAGE COMPRESSION =====
function resizeImage(file) {
  return new Promise(resolve => {
    if (!file) { resolve(''); return; }
    const img = new Image();
    img.onload = () => {
      const canvas = document.createElement('canvas');
      const max = 1024;
      const ratio = Math.min(max/img.width, max/img.height, 1);
      canvas.width = img.width * ratio;
      canvas.height = img.height * ratio;
      canvas.getContext('2d').drawImage(img, 0, 0, canvas.width, canvas.height);
      resolve(canvas.toDataURL('image/jpeg', 0.85));
    };
    img.src = URL.createObjectURL(file);
  });
}

// ===== SHORT ID GENERATION =====
function generateShortId() {
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
  let shortId = '';
  for (let i = 0; i < 6; i++) shortId += chars.charAt(Math.floor(Math.random() * chars.length));
  return shortId;
}

// ===== PAYMENT MODAL =====
function openPaymentModal() {
  document.getElementById('paymentModal').style.display = 'flex';
}

function closePaymentModal() {
  document.getElementById('paymentModal').style.display = 'none';
}

function savePaymentSettings() {
  showSuccess('‚úÖ Payment settings saved!');
  setTimeout(() => closePaymentModal(), 1000);
}

// ===== MAIN CREATE BUSINESS FUNCTION =====
async function createBusiness() {
  // Validate required fields
  if (!document.getElementById('ownerName').value) { alert('Owner name is required'); return; }
  if (!document.getElementById('phoneNumber').value) { alert('Phone number is required'); return; }
  if (!document.getElementById('businessName').value) { alert('Business name is required'); return; }
  if (!document.getElementById('address').value) { alert('Business address is required'); return; }

  showLoading();

  try {
    const businessId = crypto.randomUUID();
    
    // Collect business hours
    const businessHours = [];
    document.querySelectorAll('.dayBox').forEach(box => {
      const open = box.querySelector('.dayOpen').checked;
      const status = box.querySelector('.dayStatus').value;
      businessHours.push({
        open: open && status === 'open',
        status: status,
        start: open && status === 'open' ? box.querySelector('.dayStart').value : null,
        end: open && status === 'open' ? box.querySelector('.dayEnd').value : null
      });
    });

    // Collect holidays
    const holidays = [];
    document.querySelectorAll('.holidayItem').forEach(item => {
      const name = item.querySelector('.holidayName').value;
      const date = item.querySelector('.holidayDate').value;
      if (name.trim() && date) holidays.push({ name: name.trim(), date });
    });

    // Collect products
    const products = [];
    for (let i = 0; i < document.querySelectorAll('.offer-box').length; i++) {
      const box = document.querySelectorAll('.offer-box')[i];
      const title = box.querySelector('.productTitle')?.value;
      if (!title) continue;
      
      const file = box.querySelector('.productImage')?.files[0];
      const badges = Array.from(box.querySelectorAll('input[type=checkbox]:checked')).map(cb => cb.value);
      
      products.push({
        title,
        description: box.querySelector('.productDescription')?.value || '',
        original_price: box.querySelector('.originalPrice')?.value ? parseFloat(box.querySelector('.originalPrice').value) : null,
        discount_price: box.querySelector('.discountPrice')?.value ? parseFloat(box.querySelector('.discountPrice').value) : null,
        offer_tag: box.querySelector('.offerTag')?.value || '',
        badges,
        image_url: file ? await resizeImage(file) : '',
        is_available: true,
        is_featured: i < 4 // First 4 products are featured
      });
    }

    // Collect delivery zones
    const zones = [];
    document.querySelectorAll('.zone-item').forEach(zone => {
      const city = zone.querySelector('.zone-name')?.value.trim();
      const charge = zone.querySelector('.zone-charge')?.value;
      const time = zone.querySelector('.zone-time')?.value.trim();
      if (city && charge && time) {
        zones.push({ city, charge: parseFloat(charge), time });
      }
    });

    // Collect payment gateways
    const paymentGateways = {
      cod: { active: selectedPaymentGateways.includes('cod') },
      jazzcash: { 
        active: selectedPaymentGateways.includes('jazzcash'),
        number: document.getElementById('jazzcashNumber')?.value || ''
      },
      easypaisa: {
        active: selectedPaymentGateways.includes('easypaisa'),
        number: document.getElementById('easypaisaNumber')?.value || ''
      },
      bank: {
        active: selectedPaymentGateways.includes('bank'),
        bankName: document.getElementById('bankName')?.value || 'HBL',
        accountTitle: document.getElementById('accountTitle')?.value || '',
        accountNumber: document.getElementById('accountNumber')?.value || ''
      },
      card: {
        active: selectedPaymentGateways.includes('card'),
        merchantId: document.getElementById('merchantId')?.value || ''
      }
    };

    // Social media
    const socialMedia = {
      facebook: document.getElementById('facebook')?.value || '',
      instagram: document.getElementById('instagram')?.value || '',
      twitter: document.getElementById('twitter')?.value || '',
      linkedin: document.getElementById('linkedin')?.value || '',
      youtube: document.getElementById('youtube')?.value || '',
      tiktok: document.getElementById('tiktok')?.value || '',
      website: document.getElementById('website')?.value || ''
    };

    // ===== INSERT INTO businesses TABLE =====
    const { data: business, error: bizError } = await supabaseClient
      .from('businesses')
      .insert({
        id: businessId,
        owner_name: document.getElementById('ownerName').value.trim(),
        owner_email: document.getElementById('email')?.value?.trim() || '',
        business_name: document.getElementById('businessName').value.trim(),
        business_type: document.getElementById('businessType')?.value?.trim() || 'Digital Business',
        description: document.getElementById('businessDescription')?.value?.trim() || '',
        phone: document.getElementById('phoneNumber').value.trim(),
        email: document.getElementById('email')?.value?.trim() || '',
        address: document.getElementById('address').value.trim(),
        logo_url: document.getElementById('profileImage')?.files[0] ? await resizeImage(document.getElementById('profileImage').files[0]) : '',
        social_media: socialMedia,
        business_hours: businessHours,
        holidays: holidays,
        delivery_settings: {
          default: {
            withinCity: {
              charge: parseFloat(document.getElementById('deliveryChargeCity')?.value) || 150,
              time: document.getElementById('deliveryTimeCity')?.value || '1-2 business days'
            },
            otherCities: {
              charge: parseFloat(document.getElementById('deliveryChargeOther')?.value) || 300,
              time: document.getElementById('deliveryTimeOther')?.value || '3-5 business days'
            }
          },
          zones: zones,
          free_delivery_min: parseFloat(document.getElementById('freeDeliveryMin')?.value) || 2000
        },
        payment_gateways: paymentGateways,
        is_active: true,
        created_at: new Date().toISOString()
      })
      .select()
      .single();

    if (bizError) {
      hideLoading();
      console.error(bizError);
      alert('Error creating business: ' + bizError.message);
      return;
    }

    // ===== INSERT PRODUCTS INTO products TABLE =====
    if (products.length > 0) {
      const productsWithBusinessId = products.map(p => ({
        ...p,
        business_id: business.id
      }));
      
      const { error: prodError } = await supabaseClient
        .from('products')
        .insert(productsWithBusinessId);
      
      if (prodError) console.error('Product insert error:', prodError);
    }

    // ===== GENERATE SHORT ID =====
    const shortId = generateShortId();
    await supabaseClient
      .from('short_urls')
      .insert({
        short_id: shortId,
        business_id: business.id,
        full_url: `https://rashid253.github.io/-/business.html?id=${shortId}`
      });

    hideLoading();
    showSuccess('‚úÖ Business created successfully! Redirecting...');
    
    setTimeout(() => {
      window.location.href = `business.html?id=${shortId}`;
    }, 2000);

  } catch (error) {
    hideLoading();
    console.error(error);
    alert('Error creating business: ' + error.message);
  }
}

// ===== INITIALIZATION =====
document.addEventListener('DOMContentLoaded', function() {
  // Add containers
  document.getElementById('productsContainer').classList.add('offers-container');
  
  // Add sample data
  addProduct();
  addDeliveryZone();
  addDeliveryZone();
  
  // Set today's date for holidays
  const today = new Date().toISOString().split('T')[0];
  document.querySelectorAll('.holidayDate').forEach(d => d.value = today);
  
  // Select COD by default
  setTimeout(() => selectPaymentGateway('cod'), 100);
});
</script>
</body>
</html>
